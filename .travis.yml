matrix:
  include:

    # JupyterLab plugin check
    - language:
        python
      python:
        - "3.6"
      sudo: false
      dist: trusty

      install:
        - python -m pip install -q -U pip
        - pip install -q -U notebook
        - pip install --pre -U jupyterlab

      script:
        - ./scripts/install.sh
        - python -m jupyterlab.browser_check
        - ./scripts/uninstall.sh
        - ./scripts/dev.sh
        - python -m jupyterlab & sleep 10
        - curl http://localhost:8888/completion/status
        - ./scripts/uninstall.sh

      cache:
        pip: true
        directories:
          - $HOME/.npm

    # PyCharm Plugin check
    - language:
        java

      install: true

      before_install: cd ide-plugin

      jdk:
        - openjdk8

      before_cache:
        - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
        - rm -fr $HOME/.gradle/caches/*/plugin-resolution/

      cache:
        directories:
          - $HOME/.gradle/caches/
          - $HOME/.gradle/wrapper/

      script:
        - ./gradlew clean test
        - ./gradlew buildPlugin
